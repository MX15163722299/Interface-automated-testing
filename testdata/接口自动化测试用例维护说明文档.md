以下是针对你 Excel 中 `Sheet1` 页签的**测试用例字段详细说明与维护指导文档**，采用 Markdown 格式编写，适用于用例编写人及后续维护人员查阅与培训。

------

# 🧾 Sheet1 用例字段说明与维护指导

> 本文档适用于接口自动化测试用例的 Excel 编写与维护，详解每个字段的用途与规范，确保数据格式标准、逻辑清晰、执行无误。

------

## 📑 字段一览

`Sheet1` 中维护了以下字段（即第一行标题）：

| 字段名         | 是否必填 | 类型      | 说明                                                        |
| -------------- | -------- | --------- | ----------------------------------------------------------- |
| `id`           | ✅ 是     | int       | 用例编号，必须唯一，按顺序递增                              |
| `title`        | ✅ 是     | str       | 用例名称，简明概述本条用例的测试点                          |
| `interfaceUrl` | ✅ 是     | str (URL) | 接口的完整请求地址（包含域名+路径）                         |
| `name`         | ✅ 是     | str       | 用例标识名，用于标识该测试接口模块或接口名称                |
| `contentType`  | ✅ 是     | enum      | 请求数据格式类型，如：`json`、`form`、`params`、`none` 等   |
| `method`       | ✅ 是     | enum      | HTTP 请求方法：`get` / `post` / `put` / `delete` 等         |
| `file_var`     | ❌ 否     | str/null  | 若为文件上传接口，此字段为上传字段名（如："file"）          |
| `file_path`    | ❌ 否     | str/null  | 上传文件的本地相对路径（与 `file_var` 配合使用）            |
| `value`        | ✅ 是     | str(dict) | 请求参数，Python 字典形式，支持变量替换，如 `${2:username}` |
| `header`       | ❌ 否     | str(dict) | 请求头，Python 字典格式，支持依赖注入（如 Cookie）          |
| `rely`         | ✅ 是     | enum      | 是否存在依赖：`y`（有依赖） / `n`（无依赖）                 |
| `expect`       | ✅ 是     | str(dict) | 断言字段，支持接口断言、数据库断言，详情见下                |
| `extract`      | ❌ 否     | str(dict) | 数据提取字段，用于后续用例的数据依赖（如 token）            |

------

## 🧩 字段详细维护说明

### 🔹 `id`

- 唯一编号，不可重复。
- 推荐格式为整数，自增如：1、2、3...

### 🔹 `title`

- 用例中文名称，描述测试目的，例如：

  ```
  用户登录成功
  新用户注册失败（用户名重复）
  ```

### 🔹 `interfaceUrl`

- 接口的完整路径（包含协议+域名+端口+路径），如：

  ```
  http://localhost:5000/login
  https://api.xxx.com/v1/user/info
  ```

### 🔹 `name`

- 用例英文简称或接口别名（不能重复），建议使用蛇形命名法：

  ```
  login_user
  get_user_info
  ```

### 🔹 `contentType`

- 请求数据类型：
  - `json`：请求体为 JSON
  - `form`：表单数据格式（Content-Type: x-www-form-urlencoded）
  - `params`：GET 请求参数拼接在 URL 中
  - `none`：无参数
  - `file`：上传文件

### 🔹 `method`

- HTTP 请求方法（必须小写）：
  - `get`, `post`, `put`, `delete` 等

### 🔹 `file_var` 与 `file_path`

- 仅当接口为文件上传类型时填写：

  ```python
  file_var = "file"
  file_path = "D:/files/image.jpg"
  ```

### 🔹 `value`

- 请求参数，需为合法 Python 字典字符串：

  ```python
  {'username': 'leo', 'password': '123456'}
  ```

- 支持依赖数据替换（推荐）：

  ```python
  {'username': '${2:username}', 'info': {'age': '${2:info.age}'}}
  ```

### 🔹 `header`

- 请求头字段，JSON 格式，支持引用提取变量：

  ```python
  {'Cookie': '${2:Set-Cookie}', 'token': '${2:token}'}
  ```

### 🔹 `rely`

- 是否依赖其他用例的数据：
  - `y`：表示当前用例需要从前置用例提取数据进行替换
  - `n`：无依赖，可以独立运行

### 🔹 `expect`

- 用于断言响应字段或数据库字段：

  ```python
  {
    "interface_assert": {
      "errorcode": 0,
      "info.age": 20
    },
    "db_assert": {
      "sql": "SELECT name FROM rental_survey WHERE id=30",
      "expect": "leo"
    }
  }
  ```

  - `interface_assert`：断言接口响应字段
  - `db_assert`：断言数据库字段值是否一致

### 🔹 `extract`

- 提取响应数据，供后续用例引用：

  ```python
  {
    "token": "$.data.token",
    "user_id": "$.data.user_id"
  }
  ```

------

## ✅ 示例数据维护规范（推荐格式）

| 字段           | 示例                                                 |
| -------------- | ---------------------------------------------------- |
| `interfaceUrl` | `http://localhost:5000/login`                        |
| `value`        | `{'username': 'user1', 'password': 'p001'}`          |
| `header`       | `{'Cookie': '${2:Set-Cookie}'}`                      |
| `expect`       | `{"interface_assert":{"errorcode":0,"info.age":20}}` |
| `extract`      | `{"token":"$.token"}`                                |

------

## 🛑 常见错误示例

| 错误类型     | 错误示例             | 原因说明                                       |
| ------------ | -------------------- | ---------------------------------------------- |
| 单引号嵌套   | `'{"key": 'value'}'` | 外层用单引号，内层也用单引号冲突               |
| 无效 JSON    | `{'a': '1'}`         | 虽然符合 Python 字典，但非严格 JSON（需 eval） |
| 空参数缺字段 | `'{}'`               | 接口需要传参但未填写                           |
| 键名错误     | `"expec": {...}`     | 拼写错误字段无效                               |

------

## 🧠 建议维护流程

1. 每次新增用例复制已有结构，确保字段完整
2. 必须校验字段格式合法，特别是 `value`、`expect`、`header`
3. 所有字符串字段统一使用英文标点和引号
4. 对于复杂断言和依赖，先在 Postman 等调试通过后再录入表格
5. 定期备份并通过脚本验证字段合法性（可使用脚本自动检查）

------

